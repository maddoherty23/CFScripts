        !function() {
            window.TICKET_GATOR = {
                init(t = "ticket-container") {
                    console.log('ðŸŽ« Initializing TICKET_GATOR');
                    if (!document.getElementById(t)) {
                        const e = document.createElement("div");
                        e.id = t;
                        document.currentScript.parentElement.appendChild(e)
                    }
                    const e = document.getElementById(t);
                    this.r = document.createElement("iframe");
                    this.r.id = "ticketFrame";
                    this.r.src = "https://ticketgatorapp.netlify.app";
                    this.r.style = "width:100%;height:450px;border:none";
                    
                    this.i = document.createElement("div");
                    this.i.id = "bookingInfo";
                    this.i.style = "display:none;margin:20px;padding:15px;background:#f8f9fa;border-radius:8px;border:1px solid #dee2e6";
                    this.i.innerHTML = '<div>Booking ID: <span id="bookingId" style="font-family:monospace;font-size:16px;color:#0066cc"></span></div><div>Status: <span id="status">Pending</span></div>';
                    
                    e.appendChild(this.r);
                    e.appendChild(this.i);
                    this.r.onload = () => this.s();
                    window.addEventListener("message", t => this.h(t));
                    console.log('ðŸŽ« TICKET_GATOR initialized successfully');
                },

                s() {
                    console.log('ðŸŽ« Setting iframe variables');
                    this.r.contentWindow.postMessage({
                        type: "setVariables",
                        data: {
                            teamId: "1",
                            apiUrl: "https://madgator-f55ad62309d2.herokuapp.com",
                            eventId: "1"
                        }
                    }, "https://ticketgatorapp.netlify.app");
                    console.log('ðŸŽ« Variables sent to iframe');
                },

                async h(t) {
                    if ("https://ticketgatorapp.netlify.app" !== t.origin) {
                        console.warn('ðŸŽ« Ignored message from unauthorized origin:', t.origin);
                        return;
                    }
                    
                    const {type: e, payload: i} = t.data;
                    console.log('ðŸŽ« Received message type:', e);
                    
                    if ("BOOKING_CREATED" === e) {
                        console.log('ðŸŽ« Booking created with ID:', i.bookingId);
                        console.log('ðŸŽ« Full booking data:', i);
                        
                        this.i.style.display = "block";
                        document.getElementById("bookingId").textContent = i.bookingId;
                        
                        try {
                            console.log('ðŸŽ« Processing booking with API...');
                            const t = await fetch("https://madgator-f55ad62309d2.herokuapp.com/api/bookings/process", {
                                method: "POST",
                                headers: {"Content-Type": "application/json"},
                                body: JSON.stringify(i)
                            });
                            
                            const e = await t.json();
                            console.log('ðŸŽ« API response:', e);
                            document.getElementById("status").textContent = "Confirmed";
                            
                            const n = new URLSearchParams(window.location.search);
                            n.set("next_funnel_step", "true");
                            const o = window.location.pathname + "?" + n.toString();
                            console.log('ðŸŽ« Redirecting to:', o);
                            window.location.href = o;
                            
                        } catch(t) {
                            console.error('ðŸŽ« Error processing booking:', t);
                            document.getElementById("status").textContent = "Error"
                        }
                    }
                    
                    if ("heightUpdate" === e) {
                        this.r.style.height = i + "px";
                        console.log('ðŸŽ« Updated iframe height:', i);
                    }
                }
            };
            
            console.log('ðŸŽ« Starting TICKET_GATOR');
            TICKET_GATOR.init()
        }();
